<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>3DxValo: Operator</title>
    <style>
      body {
            margin: 0;
            background-color: #000;
            color: #fff;
            font-family: monospace;
            font-size: 0.9rem;
            line-height: 1.5rem;
            overscroll-behavior: none;
        }

        a{
            color: #ff0;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        #info {
            position: absolute;
            top: 0px;
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            text-align: center;
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
            /* pointer-events: none;  */
            z-index: 1;
        }

        a {
            pointer-events: auto; 
        }



        #OpCanvas {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: aliceblue;
        }
    
    </style>
    <script type="importmap">
{
  "imports": {
    "three": "https://cdn.jsdelivr.net/npm/three@0.178.0/build/three.module.js",
    "jsm/": "https://cdn.jsdelivr.net/npm/three@0.178.0/examples/jsm/"
  }
}
</script>
  </head>
  <body>
    <div id="info">
        <a href="https://threejs.org" target="_blank" rel="noopener">3DxValo</a><br />
        <a href="https://sketchfab.com/3d-models/operator-valorent-20c8d821adbb4f8b9015e68661d2b27f" target="_blank" rel="noopener">Operator</a> by
         <a href="https://sketchfab.com/ARjun.JS" target="_blank" rel="noopener">Arjun.js</a>
    </div>
    <div id="OpCanvas" style="width: 100vw; height: 100vh;"></div>
    <script type="module">
        import * as THREE from 'three';
        import { GLTFLoader } from 'jsm/loaders/GLTFLoader.js';
        import { OrbitControls } from 'jsm/controls/OrbitControls.js';
        import { RoomEnvironment } from 'jsm/environments/RoomEnvironment.js';

        import { KTX2Loader } from 'jsm/loaders/KTX2Loader.js'; // Optional, for compressed textures
        import { MeshoptDecoder } from 'jsm/libs/meshopt_decoder.module.js'; // Optional, for mesh optimization


        let camera, scene, renderer;

        init();
        // renderer();

        function init(){

            const container = document.getElementById( 'OpCanvas' );
            document.body.appendChild( container );

            renderer = new THREE.WebGLRenderer( { antialias: true});
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.toneMapping = THREE.ACESFilmicToneMapping;
            renderer.toneMappingExposure = 1;
            container.appendChild(renderer.domElement);

            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 2000);
            camera.position.set(386.704014140484, 51.680548246660344, 310.6834699493633)

            const environment = new RoomEnvironment();
            const pmremGenerator = new THREE.PMREMGenerator(renderer);

            scene = new THREE.Scene();
            // scene.background = new THREE.Color(0xbbbbbb);
            scene.background = new THREE.Color(0x212121);
            scene.environment = pmremGenerator.fromScene(environment).texture;
            environment.dispose();

            const grid = new THREE.GridHelper(1000, 20, 0xffffff, 0xffffff);
            grid.material.opacity = 0.5;
            grid.material.depthWrite = false;
            grid.material.transparent = true;
            scene.add( grid );

            const ktx2Loader = new KTX2Loader()
            .setTranscoderPath('jsm/libs/basis/')
            .detectSupport(renderer);

            const loader = new GLTFLoader();
            loader.setKTX2Loader(ktx2Loader);
            loader.setMeshoptDecoder(MeshoptDecoder);
            loader.load('Models/Guns/operator.glb', function(gltf){
                gltf.scene.position.y = 80;
                scene.add(gltf.scene);
                gltf.scene.scale.set(10,10,10);
                render();
            });

            const controls = new OrbitControls(camera, renderer.domElement);
            controls.addEventListener('change',render);
            controls.minDistance = 100;
            controls.maxDistance = 1000;
            // controls.target.set(20, 90, -16);
            controls.target.set(-8.993111737989222, 59.88393116325608, 11.051120284575244);
            controls.update();

            window.addEventListener('keydown', function(event) {
                if (event.code === 'ArrowUp') {
                const { x, y, z } = camera.position;
                const {x: tx, y: ty, z: tz} = controls.target;
                console.log(`camera.position.set(${x}, ${y}, ${z})`);
                console.log(`controls.target.set(${tx}, ${ty}, ${tz});`)
            }
            });

            window.addEventListener('resize', onWindowResize );
        }

        function onWindowResize(){
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();

            renderer.setSize (window.innerWidth, window.innerHeight);

            render();
        }

        function render(){
            renderer.render(scene, camera);
        }
    </script>
  </body>
</html>